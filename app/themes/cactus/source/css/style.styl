@import "_variables"
@import "_colors/" + $colors
@import "_util"
@import "_mixins"
@import "_extend"
@import "_fonts"

global-reset()

*, *:before, *:after
  box-sizing: border-box

/* Scroll bar */
/* For Firefox */
*
  scrollbar-color: $color-scrollbar transparent

/* For Chrome, Edge, and Safari */
*::-webkit-scrollbar
  width: 8px
  height: 6px

*::-webkit-scrollbar-track
  background: transparent

*::-webkit-scrollbar-thumb
  background-color: $color-scrollbar
  border-radius: 6px

*::-webkit-scrollbar-thumb:hover
  background-color: darken($color-scrollbar, 20%)

*::-webkit-scrollbar-thumb:active
  background-color: darken($color-scrollbar, 30%)

html
  margin: 0
  padding: 0
  height: 100%
  border-top: 2px solid $color-text
  -webkit-text-size-adjust: 100%
  -ms-text-size-adjust: 100%

body
  margin: 0
  min-height: 100%
  background-color: $color-background
  color: $color-text
  font-display: swap // @stylint ignore
  font-weight: 400
  font-size: $font-size
  font-family: $font-family-body
  line-height: $line-height
  text-rendering: geometricPrecision
  -webkit-font-smoothing: antialiased

  &::before
    content: ''
    position: fixed
    top: 0
    left: 0
    right: 0
    bottom: 0
    background: repeating-linear-gradient(0deg, rgba(0,0,0,0.03) 0px, rgba(0,0,0,0.03) 1px, transparent 1px, transparent 3px)
    pointer-events: none
    z-index: 9999

::selection
  background: rgba(212, 128, 170, 0.25)
  color: #fff

::-moz-selection
  background: rgba(212, 128, 170, 0.25)
  color: #fff

// === AVATAR ===
.avatar-link
  position: fixed
  top: 1rem
  left: 1rem
  z-index: 100

  img
    width: 48px
    height: 48px
    border-radius: 50%
    border: 2px solid rgba(212, 128, 170, 0.2)
    transition: border-color 0.3s ease
    display: block

    &:hover
      border-color: $color-accent-1

// === LAYOUT: sidebar + content ===
.layout
  display: flex
  width: 100%
  gap: 0

.sidebar
  flex: 0 0 30%
  max-width: 30%
  position: relative
  overflow: hidden
  transition: flex-basis 0.3s ease, max-width 0.3s ease, padding 0.3s ease

.layout.collapsed .sidebar
  flex-basis: 0
  max-width: 0

.layout.collapsed .sidebar-inner
  opacity: 0
  transition: opacity 0.15s ease

.sidebar-inner
  opacity: 1
  transition: opacity 0.2s 0.1s ease
  position: sticky
  top: 0
  max-height: 100vh
  overflow-y: auto
  padding: 1rem 1.5rem
  display: flex
  flex-direction: column-reverse

.sidebar-inner::-webkit-scrollbar
  width: 3px

.sidebar-inner::-webkit-scrollbar-track
  background: transparent

.sidebar-inner::-webkit-scrollbar-thumb
  background: $color-border
  border-radius: 3px

.sidebar-inner
  scrollbar-width: thin
  scrollbar-color: $color-border transparent

// === SIDEBAR NAV ===
.sidebar-nav
  margin-bottom: 1rem
  padding-bottom: 0.75rem
  border-bottom: 1px solid rgba(144, 141, 141, 0.27)

  a
    color: $color-accent-1
    text-decoration: none
    font-size: 0.85rem
    background-image: none
    transition: color 0.2s ease

    &:hover
      color: #fff
      background-image: none
      text-shadow: none

  .sep
    color: $color-border
    margin: 0 0.6rem
    font-size: 0.85rem

// === DIVIDER ===
.divider
  flex: 0 0 1px
  background: $color-border
  cursor: pointer
  position: relative
  transition: background 0.2s ease

  &:hover
    background: $color-accent-1

  &::before
    content: '\2039\2039'
    position: absolute
    top: 50%
    left: 50%
    transform: translate(-50%, -50%)
    color: $color-accent-1
    font-size: 0.7rem
    letter-spacing: -3px
    background: $color-background
    padding: 4px 2px
    border-radius: 3px
    opacity: 0
    transition: opacity 0.2s ease
    pointer-events: none
    white-space: nowrap

  &:hover::before
    opacity: 1

  &::after
    content: ''
    position: absolute
    top: 0
    left: -4px
    width: 9px
    height: 100%
    background: transparent
    cursor: pointer

// === EXPAND TAB ===
.expand-tab
  position: fixed
  left: 0
  top: 50%
  transform: translateY(-50%)
  width: 20px
  height: 48px
  background: lighten($color-background, 5%)
  border: 1px solid $color-border
  border-left: none
  border-radius: 0 4px 4px 0
  cursor: pointer
  display: flex
  align-items: center
  justify-content: center
  color: $color-border
  font-size: 0.7rem
  z-index: 100
  opacity: 0
  pointer-events: none
  transition: opacity 0.2s 0s ease, color 0.2s ease, border-color 0.2s ease

  &:hover
    color: $color-accent-1
    border-color: $color-accent-1

.layout.collapsed ~ .expand-tab
  opacity: 1
  pointer-events: auto
  transition: opacity 0.2s 0.2s ease, color 0.2s ease, border-color 0.2s ease

// === CONTENT ===
.content
  position: relative
  display: flex
  flex-direction: column
  min-height: 100%
  overflow-wrap: break-word

  p
    hyphens(manual)

  code
    hyphens(manual)

  a
    color: $color-accent-1
    text-decoration: none
    background-image: none
    transition: color 0.2s ease

    &:hover
      color: #fff

  a.icon
    background: none

    &:hover
      color: $color-link

  h1 a, .h1 a, h2 a, h3 a, h4 a, h5 a, h6 a
    background: none
    color: $color-main-page-header
    text-decoration: none

  h1 a:hover, .h1 a:hover, h2 a:hover, h3 a:hover, h4 a:hover, h5 a:hover, h6 a:hover
    color: #fff

  h6
    a
      background: none
      color: inherit
      text-decoration: none

    a:hover
      color: #fff

// Two-pane content area
.layout .content
  flex: 1
  min-width: 0
  padding: 1rem 2rem 3rem

// Homepage content centering
.content.homepage
  margin: 0
  padding: 0 2rem 1rem 3rem

@media (min-width: 540px)
  .image-wrap
    flex-direction: row
    margin-bottom: 2rem

    .image-block
      flex: 1 0 35%
      margin-right: 2rem

    p
      flex: 1 0 65%

@media (min-width: 480px)
  p
    text-align: justify

// === RESPONSIVE ===
@media (max-width: 768px)
  .layout
    flex-direction: column

  .sidebar,
  .layout .content
    flex: 0 0 100%
    max-width: 100%

  .sidebar-inner
    position: static
    max-height: none
    flex-direction: column
    padding: 1rem

  .layout .content
    border-left: none
    border-top: 1px solid $color-border
    padding: 1.5rem 1rem 3rem

  .divider
    display: none

  .expand-tab
    display: none

@import "_partial/header"
@import "_partial/tree"
@import "_partial/index"
@import "_partial/article"
@import "_partial/archive"
@import "_partial/comments"
@import "_partial/footer"
@import "_partial/pagination"
@import "_partial/search"
@import "_partial/tags"
@import "_partial/tooltip"
@import "_partial/categories"
// Code
@import "_highlight/" + $highlight

  code
    display: inline
    padding: 0
    border: none

code
  display: inline
  color: $color-accent-1
  background: rgba(212, 128, 170, 0.08)
  padding: 0.15em 0.35em
  border-radius: 3px
  font-size: 0.9em

.highlight
  overflow-x: auto
  margin: 1rem 0
  padding: 10px 15px
  border-radius: 4px
  background: $color-background-code
  font-family: $font-family-mono
  -webkit-border-radius: 4px

  figcaption
    margin: -5px 0 5px
    color: $color-meta-code
    font-size: .9em
    transform: scale(1)

    a
      float: right
      color: $color-meta-code
      font-style: italic
      font-size: .8em

    a:hover
      color: lighten($color-meta-code, 20%)

    &:before, content: ""
      display: table

    &:after
      clear: both

  &:hover
    .btn-copy
      opacity: 1

  .btn-copy
    font-size: 1.2rem
    position: absolute
    right: 20px
    opacity: 0
    transition: opacity 0.2s ease-in
    &:hover
      color: $color-accent-1


  table
    width: auto

  td.gutter
    text-align: right
    opacity: .2

  .line
    height: 22px
